<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Night Of Schemes - イカサマ上等チンチロ</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="game-container">
        
        <!-- タイトル画面 -->
        <div id="title-screen" class="screen">
            <div class="title-content">
                <h1 class="title-logo">Night Of Schemes</h1>
                <p class="title-subtitle">～イカサマ上等～</p>
                <button class="btn btn-primary" id="start-cpu-btn">CPU対戦</button>
                <button class="btn btn-secondary" disabled>オンライン（準備中）</button>
            </div>
        </div>

        <!-- ゲーム画面 -->
        <div id="game-screen" class="screen hidden">
            
            <!-- 上段：プレイヤー情報BOX / 試合情報 / CPU情報BOX -->
            <div class="top-row">
                <!-- 自分の情報BOX（左） -->
                <div id="player-box" class="info-box player-box">
                    <div class="box-header">
                        <div class="avatar">
                            <img src="https://img.icons8.com/material-rounded/96/user.png" alt="YOU" onerror="this.style.display='none'">
                        </div>
                        <div class="box-name">YOU</div>
                    </div>
                    <div class="stats-row">
                        <div class="stat-item">
                            <span class="stat-label">所持金</span>
                            <div id="player-money" class="stat-value green">¥10,000</div>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">掛け金</span>
                            <div id="player-bet" class="stat-value gold">¥0</div>
                        </div>
                    </div>
                    <div id="player-dice" class="dice-row">
                        <div class="dice-slot">?</div>
                        <div class="dice-slot">?</div>
                        <div class="dice-slot">?</div>
                    </div>
                    <div id="player-role" class="role-display">-</div>
                    <!-- プレイヤーの手札（裏向きミニカード） -->
                    <div id="player-hand-mini" class="card-row-mini"></div>
                </div>

                <!-- 試合情報（中央） -->
                <div class="match-info-center">
                    <div id="match-num" class="match-num">1/15</div>
                    <div id="dice-mode" class="dice-mode">通常賽</div>
                    <!-- ダイス結果表示 -->
                    <div id="dice-result-display" class="dice-result-display" style="display: none;">
                        <div id="result-role-name" class="result-role-name">-</div>
                        <div id="result-dice-values" class="result-dice-container"></div>
                    </div>
                </div>

                <!-- CPUの情報BOX（右） -->
                <div id="cpu-box" class="info-box cpu-box">
                    <div class="box-header">
                        <div class="avatar cpu">
                            <img src="https://img.icons8.com/material-rounded/96/robot.png" alt="CPU" onerror="this.style.display='none'">
                        </div>
                        <div class="box-name cpu">CPU</div>
                    </div>
                    <div class="stats-row">
                        <div class="stat-item">
                            <span class="stat-label">所持金</span>
                            <div id="cpu-money" class="stat-value">¥∞</div>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">掛け金</span>
                            <div id="cpu-bet" class="stat-value gold">¥0</div>
                        </div>
                    </div>
                    <div id="cpu-dice" class="dice-row">
                        <div class="dice-slot">?</div>
                        <div class="dice-slot">?</div>
                        <div class="dice-slot">?</div>
                    </div>
                    <div id="cpu-role" class="role-display">-</div>
                    <!-- CPUの手札（裏向きカード） -->
                    <div id="cpu-hand" class="card-row-mini"></div>
                </div>
            </div>

            <!-- 中段：役表 / 皿 / 山札・捨札 -->
            <div class="middle-row">
                <!-- 役表ボタン（左端） -->
                <button id="rank-btn" class="rank-toggle-btn">役<br>表</button>

                <!-- 皿エリア（中央） -->
                <div class="bowl-area">
                    <div class="bowl">
                        <canvas id="dice-canvas"></canvas>
                    </div>
                </div>

                <!-- 山札エリア（右側） -->
                <div id="deck-area" class="deck-area" title="クリックでドロー">
                </div>
            </div>

            <!-- アクションボタン -->
            <div class="action-row">
                <button id="action-btn" class="btn btn-action hidden">サイコロを振る</button>
                <button id="skip-btn" class="btn btn-sub hidden">確定</button>
            </div>

            <!-- 下段：自分の手札カード群 -->
            <div class="bottom-row">
                <div id="player-hand" class="player-hand-area"></div>
            </div>

            <!-- フィールド（カードアニメーション用） -->
            <div class="field" id="field"></div>
            <div id="hand-bottom"></div>

        </div>

        <!-- 結果画面 -->
        <div id="result-screen" class="screen hidden">
            <div class="result-content">
                <h1 id="result-title" class="result-title">VICTORY!</h1>
                <p class="result-label">最終所持金</p>
                <p id="result-money" class="result-money">¥100,000</p>
                <button class="btn btn-primary" id="restart-btn">タイトルへ</button>
            </div>
        </div>

        <!-- 役表ドロワー（左からスライド） -->
        <aside id="rank-panel" class="rank-drawer">
            <div class="drawer-header">
                <h2>役表</h2>
                <button id="rank-close" class="close-btn">×</button>
            </div>
            <div id="rank-mode" class="rank-mode-display">通常賽</div>
            <div id="rank-list" class="rank-list"></div>
            <div class="rank-info-box">
                <p id="info-text" class="rank-info-text"></p>
            </div>
        </aside>
        <div id="rank-overlay" class="drawer-overlay"></div>

        <!-- ベットモーダル -->
        <div id="bet-modal" class="modal hidden">
            <div class="modal-box">
                <h2>賭け金を決めろ</h2>
                <input type="range" id="bet-slider" min="100" max="10000" value="1000" step="100">
                <div class="bet-display">¥<span id="bet-value">1,000</span></div>
                <button id="bet-confirm" class="btn btn-primary">決定</button>
            </div>
        </div>

        <!-- カード詳細モーダル -->
        <div id="card-modal" class="modal hidden">
            <div class="modal-box card-detail">
                <div id="card-modal-icon" class="card-icon">🎴</div>
                <h2 id="card-modal-title">カード名</h2>
                <p id="card-modal-desc">説明文</p>
                <div class="modal-actions">
                    <button id="card-use-btn" class="btn btn-primary">使用する</button>
                    <button id="card-cancel-btn" class="btn btn-secondary">閉じる</button>
                </div>
            </div>
        </div>

        <!-- クイックビュー（ホバー） -->
        <div id="quick-view" class="quick-view">
            <div id="quick-title" class="quick-title">カード名</div>
            <div id="quick-desc" class="quick-desc">説明</div>
        </div>

        <!-- カード詳細オーバーレイモーダル -->
        <div id="card-overlay">
            <div id="overlay-content">
                <button class="overlay-close-btn" onclick="closeCardOverlay()">&times;</button>
                <div class="big-white-card">
                    <div id="big-card-title" class="big-card-title">カード名</div>
                    <div class="modal-separator"></div>
                    <div class="card-image-area">
                        <img id="card-image" src="" alt="カード画像" style="display: none;" onerror="document.getElementById('card-image').style.display='none'">
                        <div id="icon-fallback" class="icon-text-fallback">？</div>
                    </div>
                    <div class="big-card-desc-container">
                        <div id="big-card-desc" class="big-card-desc">説明</div>
                    </div>
                    <div id="big-card-cost">コスト: -0</div>
                </div>
                <button class="use-button" id="overlay-use-btn">使用する</button>
            </div>
        </div>

        <!-- 試合結果モーダル -->
        <div id="match-modal" class="modal hidden">
            <div class="modal-box match-result">
                <h2 id="match-result-title" class="match-winner">WIN!</h2>
                <div class="match-roles">
                    <div class="role-item">
                        <span class="role-label">YOU</span>
                        <span id="match-player-role">-</span>
                    </div>
                    <span class="vs">VS</span>
                    <div class="role-item">
                        <span class="role-label">CPU</span>
                        <span id="match-cpu-role">-</span>
                    </div>
                </div>
                <p id="match-payout" class="match-payout">+¥0</p>
                <button id="next-match-btn" class="btn btn-primary">次へ</button>
            </div>
        </div>

        <!-- ルール説明モーダル -->
        <div id="rules-modal" class="modal hidden">
            <div class="modal-box rules-modal">
                <h2 class="rules-modal-title">【ルール】</h2>
                <div class="rules-content">
                    <p>・目標 <span class="gold">¥100,000</span> を達成せよ</p>
                    <p>・全15試合 / 所持金 <span class="red">¥100未満</span> で敗北</p>
                    <p>・同点はCPU勝利</p>
                    <p>・山札は無制限に引ける</p>
                </div>
                <button id="rules-confirm" class="btn btn-primary">了解</button>
            </div>
        </div>

        <!-- カード使用通知モーダル -->
        <div id="card-used-notification" class="card-notification hidden">
            <div class="card-notification-content">
                <div id="notification-player-name" class="notification-player-name">プレイヤー</div>
                <div id="notification-card-name" class="notification-card-name">カード名</div>
                <div id="notification-card-desc" class="notification-card-desc">カード説明</div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/card.js"></script>
    <script src="js/dice.js"></script>
    <script src="js/coin.js"></script>
    <script type="module" src="js/main.js"></script>
</body>
</html>
